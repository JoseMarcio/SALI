<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html  lang="pt-br"
       xmlns="http://www.w3.org/1999/xhtml"
       xmlns:h="http://xmlns.jcp.org/jsf/html"
       xmlns:f="http://xmlns.jcp.org/jsf/core"
       xmlns:p="http://primefaces.org/ui">


    <f:event listener="#{loginBean.carregarInstituicao()}" type="preRenderView"/>
    <h:head>
        <title>Área de Acesso</title>
        <link rel="shortcut icon" href="../resources/imagens/miniligo.png"/>
        <link rel="stylesheet" href="../resources/css/estilo_login.css"/>

    </h:head>

    <h:body>
        <!-- Dialog para informar e-mail de recuperar senha-->
        <p:dialog widgetVar="recuperarEmail" 
                  header="Informe o seu e-mail"  
                  width="300" 
                  minWidth="300"
                  height="160" 
                  minHeight="160"
                  modal="true"
                  closable="true" 
                  position="center"
                  showEffect="effect"
                  draggable="false" 
                  resizable="false" 
                  class="dialogo">

            <h:form>
                <center>
                    <p:inputText value="#{loginBean.emailInformado}" required="true" style="text-transform: lowercase;margin-top: 40px;"
                                 requiredMessage="Informe seu e-mail"
                                 validatorMessage="E-mail inválido">
                        <f:validateRegex pattern="^[_A-Za-z0-9-]+(.[_A-Za-z0-9-]+)*@[A-Za-z0-9]+(.[A-Za-z0-9]+)*(.[A-Za-z]{2,3})$"/>
                    </p:inputText>
                 
                    <p:commandButton value="Enviar"
                                     title="Enviar"
                                     style="cursor: pointer;"
                                     action="#{loginBean.recuperarEmail()}"
                                     process="@form"
                                     update="@form"
                                     >
                      
                    </p:commandButton>
                    
                                   
                
                    
                </center>
           
                <p:messages style="color: #ffffff;" autoUpdate="true" showIcon="false"/> 

            </h:form>
        </p:dialog>


        <!-- Dialog formulário login -->
        <p:dialog header="Login"  
                  width="300" 
                  minWidth="300"
                  widgetVar="login"
                  height="150" 
                  minHeight="150"
                  modal="true" 
                  closable="false" 
                  position="center"
                  showEffect="slide"
                  draggable="false"
                  resizable="false"
                  visible="true" 
                  class="dialogo">




            <h:panelGroup rendered="#{!empty param.login_error}">
                <span id="mensagemLogin"> Erro ao efetuar o login.</span><br />
                <br/>
                <!--Motivo: # {SPRING_SECURITY_LAST_EXCEPTION.message}-->
            </h:panelGroup>

            <form id="login"  method="post" action="${request.contextPath}/j_spring_security_check">
                <table>
                    <tr>
                        <td>E-mail</td>
                        <td><input type='email' name='j_username' required="true" style="text-transform: lowercase;"/></td>
                    </tr>

                    <tr><td>Senha</td>
                        <td><input type='password' name='j_password' required="true"/></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>
                            <input type="submit" value="Acessar" style="cursor: pointer;"/>

                            <h:form>
                                <h:commandLink value="Esqueceu sua senha?" style="margin-left: 0px;" onclick="PF('recuperarEmail').show();"/>
                            </h:form>


                        </td>
                    </tr>
                </table>

            </form>

        </p:dialog>
        <!-- FIM FORMULÁRIO DE LOGIN -->

    </h:body>
</html>

