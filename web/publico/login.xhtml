<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html  lang="pt-br"
       xmlns="http://www.w3.org/1999/xhtml"
       xmlns:h="http://xmlns.jcp.org/jsf/html"
       xmlns:f="http://xmlns.jcp.org/jsf/core"
       xmlns:p="http://primefaces.org/ui">


    <h:head>
        <title>Área de Acesso</title>
        <link rel="stylesheet" href="../resources/css/estilo_login.css"/>

    </h:head>

    <h:body>
        <!-- Dialog para informar e-mail de recuperar senha-->
        <p:dialog widgetVar="recuperarEmail" 
                  header="Informe o seu e-mail"  
                  width="310" 
                  minWidth="310"
                  height="165" 
                  minHeight="165"
                  modal="true"
                  closable="false" 
                  position="center"
                  showEffect="effect"
                  draggable="false" 
                  resizable="false" 
                  class="dialogo">

            <h:form>
                <p:messages autoUpdate="true" showIcon="false"/>

                <p:inputText value="#{loginBean.emailRecuperar}" 
                             placeholder="Digite aqui o seu e-mail"
                             required="true"
                             requiredMessage="Informe o seu e-mail."
                             size="30" 
                             style="text-transform: lowercase;margin: 5px 0 10px 0;" 
                             validatorMessage="Informe um e-mail válido.">

                    <f:validateRegex pattern="[_a-z0-9-]+(.[_a-z0-9-]+)*@[a-z0-9-]+(.[a-z0-9-]+)*(.[a-z]{2,3})"/>
                </p:inputText>

                <h:panelGrid columns="2" cellspacing="2" cellpadding="3">
                    <p:commandButton value="Recuperar"
                                     title="Recuperar Senha"
                                     icon="ui-icon-check"
                                     action="#{loginBean.recuperarSenha()}" 
                                     style="width: 130px;"
                                     update="@form" />

                    <p:commandButton value="Fechar" 
                                     title="Fechar"
                                     icon="ui-icon-close"
                                     onclick="PF('recuperarEmail').hide();
                                             PF('login').show();"
                                     process="@this"
                                     style="width: 130px;"
                                     update="@form">
                    </p:commandButton>
                </h:panelGrid>
            </h:form>
        </p:dialog>






















        <!-- Dialog formulário login -->
        <p:dialog header="Login"  
                  width="319" 
                  minWidth="319"
                  widgetVar="login"
                  height="250" 
                  minHeight="250"
                  modal="true" 
                  closable="false" 
                  position="center"
                  showEffect="slide"
                  draggable="false"
                  resizable="false"
                  visible="true" 
                  class="dialogo">


            <!--
            <h:form id="login">
                <p:messages autoUpdate="true" showIcon="false"/>

                <h:panelGrid columns="1">

                    <p:outputLabel value="Email"/>
                    <p:inputText  value="#{loginBean.email}" 
                                  required="true" 
                                  requiredMessage="Informe o e-mail de acesso." 
                                  size="30" 
                                  style="text-transform: lowercase;"
                                  validatorMessage="Insira um e-mail válido.">

                        <f:validateRegex pattern="[_a-z0-9-]+(.[_a-z0-9-]+)*@[a-z0-9-]+(.[a-z0-9-]+)*(.[a-z]{2,3})"/>
                    </p:inputText>

                    <p:outputLabel value="Senha"/>
                    <p:password  value="#{loginBean.senha}" 
                                 required="true" 
                                 requiredMessage="Informe a senha de acesso." 
                                 size="30"
                                 maxlength="16"/>
                    

                    <h:panelGrid columns="2" cellspacing="3" cellpadding="10">
                        <p:commandButton action="#{loginBean.autenticarUsuario()}" 
                                         value="Acessar"
                                         title="Acessar"
                                         ajax="false"
                                         icon="ui-icon-extlink"/>

                        <h:commandLink value="Esqueceu sua senha?" 
                                       onclick="PF('login').hide();PF('recuperarEmail').show();">
                            
                            <p:ajax listener="#{loginBean.limpar()}" process="@this"/>
                        </h:commandLink>             
                    </h:panelGrid>

                </h:panelGrid>
            </h:form>
            -->

            <h:panelGroup rendered="#{!empty param.login_error}">
                <span style="color:red"> Acesso Negado.</span><br />
            </h:panelGroup>

            <form id="login" method="post" action="#{request.contextPath}/j_spring_security_check">
                <table>
                    <tr><td>Email</td>
                        <td><input type='text' name='j_username' required="true"/></td></tr>
                    <tr><td>Senha</td>
                        <td><input type='password' name='j_password' required=""/></td></tr>
                    <tr><td align="right"><input type="checkbox" name="_spring_security_remember_me"/></td>
                        <td>Entrar automaticamente</td></tr>
                    <tr><td></td>
                        <td><input type="submit" value="Acessar"/></td>
                    </tr>
                </table>
                <script>
                    document.getElementById("login").j_username.value = "#{SPRING_SECURITY_LAST_USERNAME}";
                </script>
            </form>

        </p:dialog>

    </h:body>
</html>

